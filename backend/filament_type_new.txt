class FilamentType(str, Enum):
    """
    Filament types including Bambu Lab codes (PLA-S, PLA-CF, PA-CF, etc.)
    """
    # === Standard Materials (backwards compatible) ===
    PLA = "PLA"
    PETG = "PETG"
    ABS = "ABS"
    ASA = "ASA"
    TPU = "TPU"
    PA = "PA"           # Nylon
    PC = "PC"           # Polycarbonate
    PVA = "PVA"
    OTHER = "OTHER"
    
    # === Bambu PLA Variants ===
    PLA_SUPPORT = "PLA_SUPPORT"    # Bambu PLA-S
    PLA_CF = "PLA_CF"              # Carbon Fiber PLA
    
    # === Bambu PETG Variants ===
    PETG_CF = "PETG_CF"            # Carbon Fiber PETG
    
    # === Bambu Nylon Variants ===
    NYLON_CF = "NYLON_CF"          # PA-CF, PA6-CF
    NYLON_GF = "NYLON_GF"          # PA-GF
    
    # === Bambu PC Variants ===
    PC_ABS = "PC_ABS"
    PC_CF = "PC_CF"
    
    # === Support Materials ===
    SUPPORT = "SUPPORT"
    HIPS = "HIPS"
    
    # === High Performance ===
    PPS = "PPS"
    PPS_CF = "PPS_CF"
    
    @classmethod
    def from_bambu_code(cls, bambu_code: str) -> 'FilamentType':
        """Convert Bambu code (e.g. PLA-S) to FilamentType."""
        if not bambu_code:
            return cls.OTHER
        mapping = {
            "PLA-S": cls.PLA_SUPPORT, "PLA-CF": cls.PLA_CF,
            "PETG-CF": cls.PETG_CF, "PA-CF": cls.NYLON_CF,
            "PA6-CF": cls.NYLON_CF, "PA-GF": cls.NYLON_GF,
            "PC-ABS": cls.PC_ABS, "PC-CF": cls.PC_CF,
            "PPS-CF": cls.PPS_CF,
        }
        normalized = bambu_code.upper().strip()
        if normalized in mapping:
            return mapping[normalized]
        try:
            return cls(normalized)
        except ValueError:
            return cls.OTHER
